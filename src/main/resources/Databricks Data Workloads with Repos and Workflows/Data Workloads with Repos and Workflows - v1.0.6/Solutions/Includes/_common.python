{"version":"NotebookV1","origId":2139271331630467,"name":"_common","language":"python","commands":[{"version":"CommandV1","origId":2139271331630471,"guid":"3c5b5541-b72c-42b9-864a-8dd77ac77685","subtype":"command","commandType":"auto","position":5.0,"command":"from dbacademy import dbgems\nfrom dbacademy.dbhelper import DBAcademyHelper, Paths, CourseConfig, LessonConfig\n\ncourse_config = CourseConfig(course_code = \"dwwraw\",\n                             course_name = \"data-workloads-with-repos-and-workflows-source\",\n                             data_source_name = \"data-engineer-learning-path\",\n                             data_source_version = \"v04\",\n                             install_min_time = \"2 min\",\n                             install_max_time = \"10 min\",\n                             remote_files = remote_files,\n                             supported_dbrs = [\"12.2.x-scala2.12\", \"12.2.x-photon-scala2.12\", \"12.2.x-cpu-ml-scala2.12\"],\n                             expected_dbrs = \"12.2.x-scala2.12, 12.2.x-photon-scala2.12, 12.2.x-cpu-ml-scala2.12\")\n\n\nlesson_config = LessonConfig(name = None,\n                             create_schema = True,\n                             create_catalog = False,\n                             requires_uc = False,\n                             installing_datasets = True,\n                             enable_streaming_support = False,\n                             enable_ml_support = False)\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f5b3cc5b-70b2-434d-9027-b0c4c96d8860"},{"version":"CommandV1","origId":2139271331630470,"guid":"dfb3be19-7b28-4128-9b0e-710c3efe6be3","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./_dataset_index","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4b66d835-6628-4cc3-8aa3-7464b7755145"},{"version":"CommandV1","origId":2139271331630469,"guid":"f4a9a022-4948-45f1-a370-8396a5cc70df","subtype":"command","commandType":"auto","position":3.0,"command":"%pip $pip_command","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c09cb30f-5274-4219-ae81-7c750f6d491a"},{"version":"CommandV1","origId":2139271331630468,"guid":"2fef24fb-85d2-4ac4-9fcb-d3087919d03b","subtype":"command","commandType":"auto","position":2.0,"command":"def __validate_libraries():\n    import requests\n    try:\n        site = \"https://github.com/databricks-academy/dbacademy\"\n        response = requests.get(site)\n        error = f\"Unable to access GitHub or PyPi resources (HTTP {response.status_code} for {site}).\"\n        assert response.status_code == 200, \"{error} Please see the \\\"Troubleshooting | {section}\\\" section of the \\\"Version Info\\\" notebook for more information.\".format(error=error, section=\"Cannot Install Libraries\")\n    except Exception as e:\n        if type(e) is AssertionError: raise e\n        error = f\"Unable to access GitHub or PyPi resources ({site}).\"\n        raise AssertionError(\"{error} Please see the \\\"Troubleshooting | {section}\\\" section of the \\\"Version Info\\\" notebook for more information.\".format(error=error, section=\"Cannot Install Libraries\")) from e\n\ndef __install_libraries():\n    global pip_command\n    \n    specified_version = f\"v3.0.69\"\n    key = \"dbacademy.library.version\"\n    version = spark.conf.get(key, specified_version)\n\n    if specified_version != version:\n        print(\"** Dependency Version Overridden *******************************************************************\")\n        print(f\"* This course was built for {specified_version} of the DBAcademy Library, but it is being overridden via the Spark\")\n        print(f\"* configuration variable \\\"{key}\\\". The use of version v3.0.69 is not advised as we\")\n        print(f\"* cannot guarantee compatibility with this version of the course.\")\n        print(\"****************************************************************************************************\")\n\n    try:\n        from dbacademy import dbgems  \n        installed_version = dbgems.lookup_current_module_version(\"dbacademy\")\n        if installed_version == version:\n            pip_command = \"list --quiet\"  # Skipping pip install of pre-installed python library\n        else:\n            print(f\"WARNING: The wrong version of dbacademy is attached to this cluster. Expected {version}, found {installed_version}.\")\n            print(f\"Installing the correct version.\")\n            raise Exception(\"Forcing re-install\")\n\n    except Exception as e:\n        # The import fails if library is not attached to cluster\n        if not version.startswith(\"v\"): library_url = f\"git+https://github.com/databricks-academy/dbacademy@{version}\"\n        else: library_url = f\"https://github.com/databricks-academy/dbacademy/releases/download/{version}/dbacademy-{version[1:]}-py3-none-any.whl\"\n\n        default_command = f\"install --quiet --disable-pip-version-check {library_url}\"\n        pip_command = spark.conf.get(\"dbacademy.library.install\", default_command)\n\n        if pip_command != default_command:\n            print(f\"WARNING: Using alternative library installation:\\n| default: %pip {default_command}\\n| current: %pip {pip_command}\")\n        else:\n            # We are using the default libraries; next we need to verify that we can reach those libraries.\n            __validate_libraries()\n\n__install_libraries()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"014c6af4-da26-494b-b731-086641bcc449"}],"dashboards":[],"guid":"368a0ca3-af23-4db3-99c2-19b44653f3ad","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{},"reposExportFormat":"SOURCE"}