{"version":"NotebookV1","origId":2139271331630373,"name":"DE 7.2L - Last Mile ETL with DBSQL Lab","language":"python","commands":[{"version":"CommandV1","origId":2139271331630380,"guid":"fd08dd64-3f57-450a-8128-f7385294867e","subtype":"command","commandType":"auto","position":8.0,"command":"%md --i18n-fdc3707f-0d05-422f-a30d-d20879aee165\n\n\n**NOTE**: The queries above are only designed to be run once after resetting the demo completely to reconfigure the environment. \n\nUsers will need to have **`CREATE`** and **`USAGE`** permissions on the catalog to execute them.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-9cd7f410-eead-4759-bd99-83eafb03d0df","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a256a797-e819-418b-8a06-42eff9a793d5"},{"version":"CommandV1","origId":2139271331630374,"guid":"aece9bbb-e423-42f6-a818-a4dea76a1ce4","subtype":"command","commandType":"auto","position":2.0,"command":"%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"24a93155-9569-4fb0-9960-bea595cba164"},{"version":"CommandV1","origId":2139271331630389,"guid":"a3f3929a-4563-4007-8871-c12d146ecc23","subtype":"command","commandType":"auto","position":17.0,"command":"%md --i18n-0f643bc7-e145-4f7d-b908-a42d587b847e\n\n\n\n## Create a New Dashboard\n\nSteps:\n1. Click the button with three vertical dots at the bottom of the screen and select **Add to Dashboard**.\n1. Click the **Create new dashboard** option\n1. Name your dashboard <strong>User Ping Summary **`<your_initials_here>`**</strong>\n1. Click **Save** to create the new dashboard\n1. Your newly created dashboard should now be selected as the target; click **OK** to add your visualization","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-644501a5-c5fc-45e0-bd34-728413b5d267","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d7687f78-3795-47e1-8c93-5be12a2cfd62"},{"version":"CommandV1","origId":2139271331630385,"guid":"b92b74a5-de61-4c49-80b7-f3b5884897f3","subtype":"command","commandType":"auto","position":13.0,"command":"%md --i18n-6ebf7b90-ed63-4bda-9442-7c2daff5467b\n\n\n\n## Set a Query Refresh Schedule\n\nSteps:\n1. Locate the **Schedule** button on the top right of the SQL query editor box\n1. Use the drop down to select to refresh every **1 week**, and set the time to **12:00**\n1. For day of week, select **Sunday**.\n1. Click **OK**\n\n**NOTE:** Although we are using a refresh schedule of 1 week for classroom purposes, you'll likely see shorter trigger intervals in production, such as schedules to refresh every 1 minute.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-7dc1c1c9-96c5-49f7-a1ab-deb44594cddf","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6216747c-6956-4531-80dd-a985aaa24392"},{"version":"CommandV1","origId":2139271331630398,"guid":"90aba5ca-7e1d-41b2-91a0-b42fbbdd2934","subtype":"command","commandType":"auto","position":26.0,"command":"%md --i18n-e30f3384-9466-431d-a7da-3a63fa944576\n\n\n## Set Up an Alert\n\nSteps:\n1. Use the left side bar to navigate to **Alerts**\n1. Click **Create Alert** in the top right\n1. Select your **User Counts** query\n1. Click the field at the top left of the screen to give the alert a name **`<your_initials> Count Check`**\n1. For the **Trigger when** options, configure:\n  * **Value column**: **`total_records`**\n  * **Condition**: **`>`**\n  * **Threshold**: **`15`**\n1. For **Refresh**, select **Never**\n1. Click **Create Alert**\n1. On the next screen, click the blue **Refresh** in the top right to evaluate the alert","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-facded12-10b1-4c63-a075-b7790fa3cd17","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3d43b141-9d5e-4f07-a626-f9e555f70a29"},{"version":"CommandV1","origId":2139271331630376,"guid":"70223dbe-4808-4d90-8557-471999f6ff71","subtype":"command","commandType":"auto","position":4.0,"command":"%md --i18n-8f4ac451-67de-4a02-96c1-f1438bac20d2\n\n\n\n## Run Setup Script\nThe following cells runs a notebook that defines a class we'll use to generate SQL queries.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-9ff94613-d58b-48fe-b32d-3718cbcb2f30","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b878d16c-91ce-4637-9b6d-b5260606ce55"},{"version":"CommandV1","origId":2139271331630393,"guid":"1884277f-c9fb-49cc-a175-c6146592897d","subtype":"command","commandType":"auto","position":21.0,"command":"%md --i18n-002c0d25-d8e2-4ab0-9414-b2de2c273a0a\n\n\n\n## Create a Query to Report Summary Statistics\nSteps:\n1. Execute the cell below.\n1. Save this query with the name **Ping Summary**.\n1. Run the query to calculate the current results.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-9088bbce-cf24-4731-80c0-15972786eda1","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"27c0660d-6534-4a74-94f6-f951a8f8e642"},{"version":"CommandV1","origId":2139271331630396,"guid":"02b5eae7-291c-4668-ab54-04cb4d713656","subtype":"command","commandType":"auto","position":24.0,"command":"%md --i18n-04ec8cb7-687d-42c2-99e4-b8d21734ae9a\n\n\n\n## Review and Refresh your Dashboard\n\nSteps:\n1. Use the left side bar to navigate to **Dashboards**\n1. Find the dashboard you've added your queries to\n1. Click the blue **Refresh** button to update your dashboard\n1. Click the **Schedule** button to review dashboard scheduling options\n  * Note that scheduling a dashboard to update will execute all queries associated with that dashboard\n  * Do not schedule the dashboard at this time","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-d56869f0-d544-4361-bd46-0a821ec8acb5","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ee49aac3-45a9-480e-bba8-c1fde3c482eb"},{"version":"CommandV1","origId":2139271331630390,"guid":"67488fd8-75ee-4d6d-bde7-b83856bd67b2","subtype":"command","commandType":"auto","position":18.0,"command":"%md --i18n-4f4a86a8-8324-4303-bf13-3f5ecfd7d50e\n\n\n\n## Create a Query to Calculate the Recent Average Ping\nSteps:\n1. Execute the cell below to print out the formatted SQL query.\n1. Save this query with the name **Avg Ping**.\n1. Run the query to calculate the current results.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-400bfcee-6c58-4863-b876-609950543f6f","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"379707c2-8b49-4d04-a78f-fa3169aa0853"},{"version":"CommandV1","origId":2139271331630379,"guid":"a846de8b-d823-46c9-a27c-c36bb4df9746","subtype":"command","commandType":"auto","position":7.0,"command":"DA.generate_config()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5a7c6eb4-7f77-47af-a704-bb1503a723e7"},{"version":"CommandV1","origId":2139271331630383,"guid":"2dc7044f-8df1-4a22-bab0-cb6776a72f1d","subtype":"command","commandType":"auto","position":11.0,"command":"DA.generate_load()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b4525d8b-c21c-4607-bb2c-9f407e7d3081"},{"version":"CommandV1","origId":2139271331630386,"guid":"71361939-cf42-4b99-9743-eac68fac404e","subtype":"command","commandType":"auto","position":14.0,"command":"%md --i18n-d284f19f-aa13-4aaf-957a-58d7d3d83aae\n\n\n\n## Create a Query to Track Total Records\nSteps:\n1. Execute the cell below.\n1. Save this query with the name **User Counts**.\n1. Run the query to calculate the current results.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-58aa7a7b-4b43-429d-8603-0cc1001a5ae6","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5bba4ef4-7523-45ed-a5b7-b4275a4307bb"},{"version":"CommandV1","origId":2139271331630382,"guid":"fc3ddfd9-e0d0-4f83-a03b-acf0e9b324e2","subtype":"command","commandType":"auto","position":10.0,"command":"%md --i18n-9a393708-bf8c-45fc-bfec-d6b783ac72c5\n\n\n\n## Create a Query to Load Data\nSteps:\n1. Execute the cell below to print out a formatted SQL query for loading data in the **`user_ping`** table created in the previous step.\n1. Save this query with the name **Load Ping Data**.\n1. Run this query to load a batch of data.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-a0b2608d-d22e-4085-b02f-be43b744ecf2","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d2331cb0-7721-4c10-a14d-a81accf2899c"},{"version":"CommandV1","origId":2139271331630397,"guid":"e0042faf-3aa8-4391-bdc7-d7d4ebf8110f","subtype":"command","commandType":"auto","position":25.0,"command":"%md --i18n-d99e36f0-f75d-4518-964b-1b0d61fdc5a3\n\n\n## Share your Dashboard\n\nSteps:\n1. Click the **Share** button\n1. Select **All Users** from the top field\n1. Choose **Can Run** from the right field\n1. Click **Add**\n1. Change the **Credentials** to **Run as viewer**\n\n**NOTE**: At present, no other users should have any permissions to run your dashboard, as they have not been granted permissions to the underlying databases and tables using Table ACLs. If you wish other users to be able to trigger updates to your dashboard, you will either need to grant them permissions to **Run as owner** or add permissions for the tables referenced in your queries.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-4f69c53f-8bd9-48d5-9f6f-f97045581e49","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c0371015-7e8a-41c8-bd59-44624a714b4a"},{"version":"CommandV1","origId":2139271331630392,"guid":"c5b220ca-c078-4d9a-b11b-d101de4c6e1d","subtype":"command","commandType":"auto","position":20.0,"command":"%md --i18n-acd80b38-29a3-4f6b-862e-a50834ef4919\n\n\n\n## Add a Line Plot Visualization to your Dashboard\n\nSteps:\n1. Click the **Add Visualization** button\n1. Click on the name (should default to something like **`Visualization 1`**) and change the name to **Avg User Ping**\n1. Select **`Line`** for the **Visualization Type**\n1. Set **`end_time`** for the **X Column**\n1. Set **`avg_ping`** for the **Y Columns**\n1. Set **`user_id`** for the **Group by**\n1. Click **Save**\n1. Click the button with three vertical dots at the bottom of the screen and select **Add to Dashboard**.\n1. Select the dashboard you created earlier\n1. Click **OK** to add your visualization","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-82ba8c89-8e4b-4ab5-817a-1161017a1168","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bf2f67f7-65a3-4efd-978f-d5441d7b6e33"},{"version":"CommandV1","origId":2139271331630391,"guid":"0a9d5de5-07ff-498e-9442-d2b160c23506","subtype":"command","commandType":"auto","position":19.0,"command":"DA.generate_avg_ping()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0547d4d2-672b-4c8e-aad8-2b1f3f51b321"},{"version":"CommandV1","origId":2139271331630395,"guid":"06ddb406-410d-4fda-9929-72cab58650cb","subtype":"command","commandType":"auto","position":23.0,"command":"%md --i18n-1337c56d-5dbc-45c8-8b87-80fd4f47bba5\n\n\n\n## Add the Summary Table to your Dashboard\n\nSteps:\n1. Click the button with three vertical dots at the bottom of the screen and select **Add to Dashboard**.\n1. Select the dashboard you created earlier\n1. Click **OK** to add your visualization","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-e5832d13-b8f3-40db-95cb-8c24e895cda7","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a70da54f-2a2c-4f39-b329-1dbbd8c0ac46"},{"version":"CommandV1","origId":2139271331630375,"guid":"6bdd0d7f-c2f5-49fa-b79e-cd89c13e8ddb","subtype":"command","commandType":"auto","position":3.0,"command":"%md --i18n-d9098b9a-dff7-4d31-bd16-08ef6e4969f6\n\n\n\n# Last Mile ETL with Databricks SQL\n\nBefore we continue, let's do a recap of some of the things we've learned so far:\n1. The Databricks workspace contains a suite of tools to simplify the data engineering development lifecycle\n1. Databricks notebooks allow users to mix SQL with other programming languages to define ETL workloads\n1. Delta Lake provides ACID compliant transactions and makes incremental data processing easy in the Lakehouse\n1. Delta Live Tables extends the SQL syntax to support many design patterns in the Lakehouse, and simplifies infrastructure deployment\n1. Multi-task jobs allows for full task orchestration, adding dependencies while scheduling a mix of notebooks and DLT pipelines\n1. Databricks SQL allows users to edit and execute SQL queries, build visualizations, and define dashboards\n1. Data Explorer simplifies managing Table ACLs, making Lakehouse data available to SQL analysts (soon to be expanded greatly by Unity Catalog)\n\nIn this section, we'll focus on exploring more DBSQL functionality to support production workloads. \n\nWe'll start by focusing on leveraging Databricks SQL to configure queries that support last mile ETL for analytics. Note that while we'll be using the Databricks SQL UI for this demo, SQL Warehouses <a href=\"https://docs.databricks.com/integrations/partners.html\" target=\"_blank\">integrate with a number of other tools to allow external query execution</a>, as well as having <a href=\"https://docs.databricks.com/sql/api/index.html\" target=\"_blank\">full API support for executing arbitrary queries programmatically</a>.\n\nFrom these query results, we'll generate a series of visualizations, which we'll combine into a dashboard.\n\nFinally, we'll walk through scheduling updates for queries and dashboards, and demonstrate setting alerts to help monitor the state of production datasets over time.\n\n## Learning Objectives\nBy the end of this lesson, you should be able to:\n* Use Databricks SQL as a tool to support production ETL tasks backing analytic workloads\n* Configure SQL queries and visualizations with the Databricks SQL Editor\n* Create dashboards in Databricks SQL\n* Schedule updates for queries and dashboards\n* Set alerts for SQL queries","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-9390aad6-4d8b-4e7f-8851-18ca0b6bf7c6","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"199d9141-29cd-45da-a99d-04075bf90db8"},{"version":"CommandV1","origId":2139271331630399,"guid":"d5abd2ad-9930-46df-9907-05e132d0f81e","subtype":"command","commandType":"auto","position":27.0,"command":"DA.cleanup()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"51d1da3a-80b0-4c0b-b72a-50d09d29bf96"},{"version":"CommandV1","origId":2139271331630381,"guid":"5deca4b6-02a9-470c-81b1-94a5d40dbc7f","subtype":"command","commandType":"auto","position":9.0,"command":"%md --i18n-34c5335d-a03e-41f5-9084-ea86155a1066\n\n**WARNING:** Make sure to select your database before proceeding as the **`USE`** statement<br/>doesn't yet change the database against which your queries will execute","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-3652d1e3-fc73-44f9-9b07-6b1b8b5343d6","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"df68f63a-8916-4edd-9ac6-de00034adc9c"},{"version":"CommandV1","origId":2139271331630387,"guid":"a809e1f7-b248-4212-a56b-5379d7d816b2","subtype":"command","commandType":"auto","position":15.0,"command":"DA.generate_user_counts()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d98d9a28-34ef-4aae-9ada-412e0f3c1c4b"},{"version":"CommandV1","origId":2139271331630378,"guid":"19540b48-24f9-4309-850c-d806270b61b7","subtype":"command","commandType":"auto","position":6.0,"command":"%md --i18n-3ac390db-ebe5-4008-8509-164fc59c4e1d\n\n## Create a Demo Database \nExecute the following cell and copy the results into the Databricks SQL Editor.\n\nThese queries:\n* Create a new database\n* Declare two tables (we'll use these for loading data)\n* Declare two functions (we'll use these for generating data)\n\nOnce copied, execute the query using the **Run** button.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-c384931f-c934-440f-9f0c-a7b04c1c28b0","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"315c1924-ef69-4621-9640-848c9cde3ff7"},{"version":"CommandV1","origId":2139271331630384,"guid":"bd2e6d08-3b90-48f0-a9c4-ce73f40c6ae5","subtype":"command","commandType":"auto","position":12.0,"command":"%md --i18n-60c03dcc-812d-4037-8d79-8ecafec55acd\n\n\n\nExecuting the query should load some data and return a preview of the data in the table.\n\n**NOTE**: Random numbers are being used to define and load data, so each user will have slightly different values present.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-48fc3085-b405-450f-9463-ee1501cd56aa","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e0d53df0-36f3-4f1a-8b95-da8ba06f6d7d"},{"version":"CommandV1","origId":2139271331630388,"guid":"5ea5f90f-f174-4fa2-b00e-c663a854409e","subtype":"command","commandType":"auto","position":16.0,"command":"%md --i18n-ee4c0450-02e6-443a-9d17-53853d7786b5\n\n\n\n## Create a Bar Graph Visualization\n\nSteps:\n1. Click the **+** sign next to the results tab in middle of window, and select **Visualization** from the dialog box\n1. Click on the name (should default to something like **`Bar 1`**) and change the name to **Total User Records**\n1. Set **`user_id`** for the **X Column**\n1. Set **`total_records`** for the **Y Column**\n1. Click **Save**","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-c43c8f47-c8c3-4232-9a76-f82bdd204317","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d32c6e89-be05-4eed-8cb1-324538d664a3"},{"version":"CommandV1","origId":2139271331630377,"guid":"f014f383-9a71-43a2-a700-dd2cf4cc77aa","subtype":"command","commandType":"auto","position":5.0,"command":"%run ./Includes/Classroom-Setup-07.2","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2dfdb9cf-c48f-4a57-a0be-ceda49f3bc5b"},{"version":"CommandV1","origId":2139271331630400,"guid":"93c1ba6a-22eb-4119-b1b3-007541a50a4f","subtype":"command","commandType":"auto","position":28.0,"command":"%md-sandbox\n&copy; 2023 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"https://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"https://help.databricks.com/\">Support</a>","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6b5a8676-c19a-4a6a-bf31-0c3325ab3946"},{"version":"CommandV1","origId":2139271331630394,"guid":"ae754059-9ec7-4a48-a1ef-f82adb9d546f","subtype":"command","commandType":"auto","position":22.0,"command":"DA.generate_summary()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bd70730b-0acc-48ba-9874-d2c3739ce21f"}],"dashboards":[],"guid":"13f81c8e-6aca-4d2d-b4c8-21fdd7c27e2a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{},"reposExportFormat":"SOURCE"}