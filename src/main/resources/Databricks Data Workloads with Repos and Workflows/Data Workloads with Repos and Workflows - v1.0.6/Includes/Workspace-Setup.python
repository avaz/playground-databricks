{"version":"NotebookV1","origId":2139271331630437,"name":"Workspace-Setup","language":"python","commands":[{"version":"CommandV1","origId":2139271331630460,"guid":"b1b74d21-fe8c-478a-b108-fd99c7d85683","subtype":"command","commandType":"auto","position":24.0,"command":"print(f\"Setup completed {dbgems.clock_stopped(setup_start)}\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7e037c93-20e9-4609-88c0-bd8d0df29831"},{"version":"CommandV1","origId":2139271331630455,"guid":"2a8c4894-ffc1-4aab-bd24-2d5b126edc45","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n\n## Update Grants\nThis operation executes **`GRANT CREATE ON CATALOG TO users`** to ensure that students can create databases as required by this course when they are not admins.\n\nNote: The implementation requires this to execute in another job and as such can take about three minutes to complete.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-e95863bc-993b-46af-b96e-6f5fb01796ee","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7b6aa0e8-3158-4e3e-aa2b-44cbdc943da1"},{"version":"CommandV1","origId":2139271331630456,"guid":"fe25d1e4-3f81-4523-bd46-cbd3b6534143","subtype":"command","commandType":"auto","position":20.0,"command":"from dbacademy.dbhelper.databases_helper_class import DatabasesHelper\n\n# Ensures that all users can create databases on the current catalog \n# for cases wherein the user/student is not an admin.\njob_id = DatabasesHelper.configure_permissions(DA.client, \"Configure-Permissions\", \"10.4.x-scala2.12\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8ddef9c8-34f9-41cc-9c57-9113195289f2"},{"version":"CommandV1","origId":2139271331630446,"guid":"31305c2c-c768-430e-976b-710fce3fc555","subtype":"command","commandType":"auto","position":10.0,"command":"from dbacademy.dbhelper import ClustersHelper\n\norg_id = dbgems.get_org_id()\nlab_id = WorkspaceHelper.get_lab_id() or \"UNKNOWN\"\nspark_version = WorkspaceHelper.get_spark_version()\nworkspace_name = WorkspaceHelper.get_workspace_name()\nworkspace_description = WorkspaceHelper.get_workspace_description() or \"UNKNOWN\"\n\nprint(f\"org_id:                {org_id}\")\nprint(f\"lab_id:                {lab_id}\")\nprint(f\"spark_version:         {spark_version}\")\nprint(f\"workspace_name:        {workspace_name}\")\nprint(f\"workspace_description: {workspace_description}\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"68425d84-2821-4cfd-9cec-e362e5f574d4"},{"version":"CommandV1","origId":2139271331630461,"guid":"6180d99e-e0ec-4f78-a17b-f55f5ff9514b","subtype":"command","commandType":"auto","position":25.0,"command":"%md-sandbox\n&copy; 2023 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"https://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"https://help.databricks.com/\">Support</a>","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2f599aa8-8671-40e3-bc2a-261051158740"},{"version":"CommandV1","origId":2139271331630454,"guid":"09122a46-a2dd-4e5a-86ac-f4657924f07c","subtype":"command","commandType":"auto","position":18.0,"command":"WorkspaceHelper.add_entitlement_workspace_access(client=DA.client)\nWorkspaceHelper.add_entitlement_databricks_sql_access(client=DA.client)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9a52ec9a-f7ae-4038-b6a5-bb315391464a"},{"version":"CommandV1","origId":2139271331630447,"guid":"1758a23e-fffc-47f7-ae84-275ae0094a5c","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n\n## Create Class Instance Pools\nThe following cell configures the instance pool used for this class","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-0e8ed29d-2dba-4814-bbdb-33ad8bf9a4be","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a5279bc9-e856-44df-b3a2-60a4a56ba01b"},{"version":"CommandV1","origId":2139271331630443,"guid":"702dff1e-1f07-41e5-bd58-488d022f4969","subtype":"command","commandType":"auto","position":7.0,"command":"from dbacademy.dbhelper import WorkspaceHelper\n\n# Setup the widgets to collect required parameters.\ndbutils.widgets.dropdown(\"configure_for\", WorkspaceHelper.CONFIGURE_FOR_ALL_USERS, \n                         [WorkspaceHelper.CONFIGURE_FOR_ALL_USERS], \"Configure For (required)\")\n\n# lab_id is the name assigned to this event/class or alternatively its class number\ndbutils.widgets.text(WorkspaceHelper.PARAM_LAB_ID, \"\", \"Lab/Class ID (optional)\")\n\n# a general purpose description of the class\ndbutils.widgets.text(WorkspaceHelper.PARAM_DESCRIPTION, \"\", \"Description (optional)\")\n\n# The default spark version\ndbutils.widgets.text(WorkspaceHelper.PARAM_SPARK_VERSION, \"12.2.x-cpu-ml-scala2.12\", \"Spark Version (optional)\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"98873eb9-e8ed-4818-b388-09896a3440c8"},{"version":"CommandV1","origId":2139271331630440,"guid":"b60f5d6b-44a5-446d-9e36-e73d21692855","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./_common","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"21b49b2b-db90-4fe9-8785-4196281f0fbd"},{"version":"CommandV1","origId":2139271331630450,"guid":"d207f98d-6705-4e08-b6df-a466e4d05c5e","subtype":"command","commandType":"auto","position":14.0,"command":"# org_id, lab_id, workspace_name and workspace_description are attached to the\n# instance pool and as such, they are not attached to the all-purpose or jobs policies.\n\nClustersHelper.create_all_purpose_policy(client=DA.client, \n                                         instance_pool_id=instance_pool_id, \n                                         spark_version=spark_version,\n                                         autotermination_minutes_max=180,\n                                         autotermination_minutes_default=120)\n\nClustersHelper.create_jobs_policy(client=DA.client, \n                                  instance_pool_id=instance_pool_id, \n                                  spark_version=spark_version)\n\nClustersHelper.create_dlt_policy(client=DA.client, \n                                 org_id=org_id, \n                                 lab_id=lab_id, \n                                 workspace_name=workspace_name, \n                                 workspace_description=workspace_description)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6e8e1c45-d9b3-49a4-9efc-f3d977540221"},{"version":"CommandV1","origId":2139271331630438,"guid":"53a700ed-5513-4bbd-a92c-84159b61c5be","subtype":"command","commandType":"auto","position":2.0,"command":"%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9ecf5892-28b9-4bb6-8b34-db72270b496f"},{"version":"CommandV1","origId":2139271331630453,"guid":"6304bcb7-95ba-4169-af01-bc5059893ff5","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n\n## Configure User Entitlements\n\nThis task simply adds the \"**databricks-sql-access**\" entitlement to the \"**users**\" group ensuring that they can access the Databricks SQL view.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-908300af-d69a-4a8a-b842-b67d3dafdb6b","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"74728763-f8a8-47c9-9b9f-2ef57aa3307d"},{"version":"CommandV1","origId":2139271331630444,"guid":"fe453c6c-5a55-4783-8fe7-61a73f2439e2","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n\n# Init Script & Install Datasets\nThe main affect of this call is to pre-install the datasets.\n\nIt has the side effect of create our DA object which includes our REST client.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-f0fa4b17-6a50-4fb1-9792-006194671ee3","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"33f4ce25-5ed8-4780-964b-4bbf0556eb18"},{"version":"CommandV1","origId":2139271331630457,"guid":"63e4d56d-6c6b-4c44-b1fa-207af696e211","subtype":"command","commandType":"auto","position":21.0,"command":"DA.client.jobs().delete_by_id(job_id)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d74e27bc-8e7d-43a3-92d9-fad2165f2353"},{"version":"CommandV1","origId":2139271331630449,"guid":"ef20bd34-bf2c-4b98-863d-2c2d16467a72","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n\n## Create The Three Class-Specific Cluster Policies\nThe following cells create the various cluster policies used by the class","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-3247e3f2-2c46-4fb9-ae6c-eb26f15c963d","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4b13e681-98e2-487a-9dbf-387a278b0c89"},{"version":"CommandV1","origId":2139271331630452,"guid":"b1ac9e11-85fc-4af7-886e-d257471a5458","subtype":"command","commandType":"auto","position":16.0,"command":"from dbacademy.dbhelper.warehouses_helper_class import WarehousesHelper\n\nDA.workspace.warehouses.create_shared_sql_warehouse(name=WarehousesHelper.WAREHOUSES_DEFAULT_NAME)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"55c5b409-53d5-440e-818a-6e56dbee97ab"},{"version":"CommandV1","origId":2139271331630448,"guid":"782d3a88-d825-48d0-ade6-e22edb50e137","subtype":"command","commandType":"auto","position":12.0,"command":"instance_pool_id = DA.workspace.clusters.create_instance_pool(preloaded_spark_version=spark_version,\n                                                              org_id=org_id, \n                                                              lab_id=lab_id, \n                                                              workspace_name=workspace_name, \n                                                              workspace_description=workspace_description)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fb394ffd-64a4-4269-8b75-b050b1e0984d"},{"version":"CommandV1","origId":2139271331630458,"guid":"b973f40a-0b5d-4b64-a777-7643ee9bb2e5","subtype":"command","commandType":"auto","position":22.0,"command":"%md\nExecuting the operation below ensures that students can create catalogs as required by Unity Catalog content in this course when they are not admins.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-99369c09-72d7-40f1-8081-3a6603156e12","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b1151a40-3c9a-4ce3-adc7-cbf0f70611f8"},{"version":"CommandV1","origId":2139271331630441,"guid":"41d627dc-0c68-4f35-8128-473c2202f453","subtype":"command","commandType":"auto","position":5.0,"command":"# Start a timer so we can benchmark execution duration.\nsetup_start = dbgems.clock_start()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b9dd98d4-c5d3-4a40-ae9a-06e7d71768d9"},{"version":"CommandV1","origId":2139271331630439,"guid":"c0184843-b43d-4757-b9e8-7e970469d4bb","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n\n# Workspace Setup\nThis notebook should be run by instructors to prepare the workspace for a class.\n\nThe key changes this notebook makes includes:\n* Updating user-specific grants such that they can create databases/schemas against the current catalog when they are not workspace-admins.\n* Configures three cluster policies:\n    * **DBAcademy** - which should be used on clusters running standard notebooks.\n    * **DBAcademy Jobs** - which should be used on workflows/jobs\n    * **DBAcademy DLT** - which should be used on DLT piplines (automatically applied)\n* Create or update the shared **DBAcademy Warehouse** for use in Databricks SQL exercises\n* Create the Instance Pool **DBAcademy** for use by students and the \"student\" and \"jobs\" policies.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-d55711b9-31d9-44a4-a64b-9a80e704adb5","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fb416337-af9d-4454-9982-ddb7ddbe2b3e"},{"version":"CommandV1","origId":2139271331630445,"guid":"7115f96c-b014-41ec-88ff-fff47dbf3191","subtype":"command","commandType":"auto","position":9.0,"command":"lesson_config.create_schema = False\n\nDA = DBAcademyHelper(course_config, lesson_config)\nDA.reset_lesson()\nDA.init()\nDA.conclude_setup()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9b00ba2a-4da2-4e19-948a-6c5c835d58b0"},{"version":"CommandV1","origId":2139271331630451,"guid":"f82c8edb-38b7-4eec-a19b-54ea6f6c1e35","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n\n## Create Class-Shared Databricks SQL Warehouse/Endpoint\nCreates a single wharehouse to be used by all students.\n\nThe configuration is derived from the number of students specified above.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-4b9690bf-081b-4f09-bd30-d892286b2592","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b72b60c6-e2c1-4775-8bf6-2d7e7506f13b"},{"version":"CommandV1","origId":2139271331630442,"guid":"c2d72af3-862f-4195-90ae-0706d4b99a31","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n# Get Class Config\nThe three variables defined by these widgets are used to configure our environment as a means of controlling class cost.","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"--i18n-e181db51-2e1b-403c-8a24-4804cfd935ed","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6a8af5d5-c869-4cdb-b7a3-a4a429e9eac2"},{"version":"CommandV1","origId":2139271331630459,"guid":"ae3c8762-aec9-41c4-844a-4d713e3c27b8","subtype":"command","commandType":"auto","position":23.0,"command":"spark.sql(\"GRANT CREATE CATALOG ON METASTORE TO `account users`;\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a6a08447-1b44-4547-b596-81be5196f748"}],"dashboards":[],"guid":"5eeb1baa-2b21-4bee-9250-8ad3ba245736","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{},"reposExportFormat":"SOURCE"}